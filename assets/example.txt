COPY	START	1000
FIRST	STL	RETADR
CLOOP	JSUB	RDREC
A	LDA	LENGTH
C	COMP	ZERO
B	JEQ	ENDFIL
V	JSUB	WRREC
N	J	CLOOP
ENDFIL	LDA	EOF
H	STA	BUFFER
T	LDA	THREE
R	STA	LENGTH
E	JSUB	WRREC
W	LDL	RETADR
Q	RSUB
EOF	BYTE	C'EOF'
THREE	WORD	3
ZERO	WORD	0
RETADR	RESW	1
LENGTH	RESW	1
BUFFER	RESB	4096
.	
.	SUBROUTINE TO READ RECORD INTO BUFFER
.
RDREC	LDX	ZERO
Y	LDA	ZERO
RLOOP	TD	INPUT
G	JEQ	RLOOP
M	RD	INPUT
P	COMP	ZERO
L	JEQ	EXIT
U	STCH	BUFFER,X
Z	TIX	MAXLEN
	JLT	RLOOP
EXIT	STX	LENGTH
	RSUB
INPUT	BYTE	X'F1'
MAXLEN	WORD	4096
.
.	SUBROUTINE TO WRITE RECORD FROM BUFFER
.
WRREC	LDX	ZERO
WLOOP	TD	OUTPUT
23	JEQ	WLOOP
	LDCH	BUFFER,X
	WD	OUTPUT
	TIX	LENGTH
	JLT	WLOOP
	RSUB	
OUTPUT	BYTE	X'05'
	END	FIRST